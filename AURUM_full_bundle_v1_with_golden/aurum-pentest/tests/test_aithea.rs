use aurum_pentest::{aeon, hash::blake3_ds, validator::{Block, validate_block}};
#[test] fn ai_audit_block_valid(){ let ai_output=b"The quick brown fox jumps over the lazy dog"; let t_star=aeon::calculate_t_star(ai_output); let mut public=Vec::new(); public.extend_from_slice(ai_output); public.extend_from_slice(&t_star.to_be_bytes()); let blake3_root=blake3_ds("AURUM/AIAudit/Output", &public).unwrap(); let poseidon_root=blake3_root; let block=Block{poseidon_root, blake3_root}; assert!(validate_block(&block).is_ok()); }
#[test] fn ai_audit_block_invalid(){ let ai_output=b"The quick brown fox jumps over the lazy dog"; let t_star=aeon::calculate_t_star(ai_output); let mut public=Vec::new(); public.extend_from_slice(ai_output); public.extend_from_slice(&t_star.to_be_bytes()); let blake3_root=blake3_ds("AURUM/AIAudit/Output", &public).unwrap(); let tampered=blake3_ds("AURUM/AIAudit/Output", b"tampered").unwrap(); let block=Block{poseidon_root: blake3_root, blake3_root: tampered}; assert!(validate_block(&block).is_err()); }
